---
title: "Autonomous Resistor Sorter - Blog #4"
date: 2022-11-19


---


## MLVS

An attempt was made to increase the color accuracy of the MLVS system during this work period. As mentioned in previous blogs, the color classification is based on k nearest neighbors. Initially, we picked a K value of 3, as this is the most common K value used. In order to make sure we were picking the k value that resulted in the minimal error rate, we wrote a script that picks k values between 1-100 and calculates the accuracy. After running the script, it was found that the optimal k value for our application was indeed 3. See the graph below for a k-value vs accuracy plot. The k value of 3 resulted in the optimal accuracy of 64% on our test dataset.


<p style="text-align:center">
<img src="\Autonomous-Resistor-Sorter\assets\images\post_11_19_22\KValuePlot.png" alt="K Value vs Accuracy">
<br/>
Figure 1. Initial Separation Circuit
</p>

The next issue identified was making sure that the camera was focused when taking pictures to inference. We developed and implemented a simple algorithm to determine if the camera is in focus. Essentially, we took the average of subsequent image frames and waited until there was a small difference for 5 concurrent frames. After 5 concurrent frames with a low difference, it was safe to assume that the camera was focused and ready to capture a new frame. This added overhead to our inference time because due to the environment being unstable due to lighting and motion, it would often take the camera over half a second to focus. We observed no noticeable change to the accuracy by implementing focus to the camera. 
The problem we were still facing was the color classifier was classifying all the bands as white. We decided to investigate further by capturing a live view of the device and motoring what the camera was exactly seeing. Below is an example captured frame.


<p style="text-align:center">
<img src="\Autonomous-Resistor-Sorter\assets\images\post_11_19_22\White_Light.png" alt="White Light">
<br/>
Figure 1. Initial Separation Circuit
</p>

As seen in the image, the frame is flooded with white light. Specifically, the middle of the color bands is white. The knn algorithm looks at the middle color of the bands to determine the colors. As a result, it can be safely assumed that the white light is a major cause of the low accuracy. 
We are now in the process of manufacturing and fitting a cover for the camera to have a controlled lighting environment for the resistors. We hope this will greatly improve the accuracy of the MLVS.

## Effect of the Validation Test Results on Fault-Detecting Neural Network Development

The last component of the project to be implemented in these final weeks was the fault-detecting neural network; however, we have encountered an unforeseen setback: the lack of nominal operational data with which to train the neural network. As designed, the neural network, conceived as a Multilayer Perceptron composed of three hidden layers, was to be trained on the input signals provided by the MLVS to the Delivery & Storage Subsystem. These input signals consist of the resistance values of each resistor as detected by the MLVS as well as the time elapsed between each incoming resistance value. Once the network was trained on a dataset consisting of nominal and off-nominal data, the network should be able to detect when off-nominal signals arrive, indicating a system fault has occurred. However, due to the extraordinarily low accuracy of the separator subsystem and as well as the MLVS (6% and 51% separation/sorting accuracy, respectively), the system currently runs permanently in an off-nominal state. That is, the system experiences constant and pervasive faults when run. Therefore, unless the performance of the separation subsystem and the MLVS can be drastically improved, there is no nominal system data to collect, and therefore the training data for the neural network cannot be collected. Since the neural-network architecture has however already been designed, the fault-detecting neural network could still be implemented, provided that the sorting accuracy of the system is improved.
